{% extends 'layout.html'%}
{% load static %}
{% block title %}Deductions Incentives{% endblock %}
{% block css %}
<link href="{% static 'admin_assets/css/style.css' %}" rel="stylesheet" type="text/css" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet" type="text/css" />
{% endblock %}
{% block body %}
{% include "partials/_session.html" %}
<style>
    .checkbox-style {
        margin-left: 5px;
        margin-right: 5px;
    }

    .checkboxes {
        box-sizing: border-box;
        width: 15px;
        height: 15px;
        margin: 6px;
        padding: 0;
        border: 2px solid rgb(128, 128, 128);
    }
</style>
<div class="row">
    <div class="col-md-12">
        <div class="tile shadow">
            <div>
                <a href="{% url 'add_deductions_incentives' %}" class="add_btn">Add Deductions OR Incentives <i
                        class="fa fa-plus"></i></a>
            </div>
            <ul class="breadcrumb mt-2">
                <li class="breadcrumb-item">Deductions Incentives</li>

            </ul>
            <div class="row">

                <div class="col-md-6">
                    <div class="form-group">
                        <select id="user-search" name="user" class="form-control">
                            <option value="">Select User</option>
                            {% for user in users %}
                            <option value="{{user.id}}">{{user.username}}</option>
                            {%endfor%}
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <input type="date" id="date-search" name="date" class="form-control">
                    </div>
                </div>
            </div><!-- end of row -->
            <div class="row">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered" id="datatables" style="width: 100%;">
                        <thead>
                            <tr>
                                <th>Employee</th>
                                <th>Branch</th>
                                <th>Reason</th>
                                <th>Dayes</th>
                                <th>Create At</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                    </table>
                </div><!-- end of table responsive -->
            </div><!-- end of col -->
        </div><!-- end of row -->
    </div><!-- end of tile -->
</div><!-- end of row -->
{% endblock %}
{% block js %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>
<script src="{% static 'admin_assets/js/alert.js' %}" type="text/javascript"></script>

<script type="text/javascript"
    src="{% static 'admin_assets/global/plugins/jquery.dataTables/jquery.dataTables.min.js' %}"></script>
<script type="text/javascript"
    src="{% static 'admin_assets/global/plugins/dataTables.bootstrap/dataTables.bootstrap.min.js' %}"></script>

<!--DATATABLE END -->
<!--toastr -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
<!-- <script src="{% static 'admin_assets/js/custom/index.js' %}"></script> -->
<script>
    var table = $('#datatables').DataTable({
        "processing": true,
        "serverSide": true,
        searching: false,
        //lengthChange: false, 
        lengthMenu: [5, 10, 25, 50, 75, 100],
        "columnDefs": [{ "orderable": false, "targets": [0] }],
        "ajax": {
            "url": "/api/deductions_incentives/",
            "type": "GET",
            data: function (d) {
                d.user = $('#user-search').val();
                d.date = $('#date-search').val();

                // Add more custom parameters as needed
            }
        },
        "columns": [
            { "data": "user_field" },
            { "data": "branch_field" },
            { "data": "reason" },
            { "data": "amount" },
            { "data": "created_at" },
            {
                targets: 0, // Target the first column
                orderable: false,

                render: function (data, type, row) {
                    if (row.status == 0) {
                        return '<button type="button"  class="btn btn-xs btn-danger">Deductions</button>';
                    } else {
                        return '<button type="button"  class="btn btn-xs btn-info">Incentives</button>';
                    }
                }
            },
        ]
    });
    $('#date-search').on('change', function () {
        table.column(0).search(this.value).draw();
        // table.search(this.value).draw(); 
    });
    $('#user-search').on('change', function () {
        table.column(0).search(this.value).draw();
        // table.search(this.value).draw(); 
    });
</script>
{% endblock %}